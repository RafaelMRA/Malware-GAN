# Malware-GAN
This is a realization of <a href="https://arxiv.org/abs/1702.05983">"Generating Adversarial Malware Examples for Black-Box Attacks Based on GAN"</a>.
The reaserch is done in Institute of Automation, Chinese Academy of Sciences, Summer 2018. http://english.ia.cas.cn/ with the help of my mentor XuBo.

## Introduction
The idea is to use a generative adversarial network (GAN) based algorithm to generate adversarial malware examples, which are able to bypass black-box machine learning based detection models.
![alt text](https://github.com/yanminglai/Malware-GAN/blob/master/figures/Architecture.png)


## Dependencies
```Anaconda``` ```Tensorflow``` ```Keras``` ```Sklearn``` ```Cuckoo Sandbox```

## Dataset
The original malware sample is acquired from https://virusshare.com/, I have used 3000 malware samples and 1500 benign samples for trainning and testing(will expand further).

I used the ```Cuckoo Sandbox``` to extract API features from samples. https://cuckoo.readthedocs.io/en/2.0.3/

128 API features are selcted as dimensional vectors to be input to the neutual network.

## Experiments

MalGAN Architecture:
generator：128+20—256—128     
subsitite detector：128—256—1
maximum epoch：100

Training Set	     Test Set
Original	Adver.	Original	Adver.
RF	98.32	2.73	  98.87	3.56
LR	98.53	10.32	  99.27	11.67
DT	0 	0	        100	0
SVM	98.08	17.36	  97.44	14.23
MLP	98.08	0.71	  98.17	0
VOTE 98.72	12.13	96.71	13.51

